<% provide :title, "All Documents" %>
<div class="container-fluid">
  <!-- <p id="notice"><%= notice %></p> -->

  <div id="wrapper" style="margin-top:-1.3%;">

        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="sidebar-brand">
                  <a href="<%= root_path %>"><i class="fa fa-tachometer" aria-hidden="true"></i> &nbsp;
                      Home
                  </a>
                </li>
                <li><a data-toggle="tooltip" title="User Name : <%= current_user.username %>"><span class="glyphicon glyphicon-user"></span> &nbsp; <%= current_user.username %> </a></li>
                <li><a data-toggle="tooltip" title="User Email : <%= current_user.email %>"><i class="fa fa-envelope" aria-hidden="true"></i>&nbsp; <%= current_user.email %> </a></li>
                <% if current_user && (can? :create, Document) %>
                  <li>
                    <a href="<%= new_document_path %>">
                      <span class="glyphicon glyphicon-cloud-upload"></span> &nbsp; Upload Document
                    </a>
                  </li>
                <% end %>
                <!-- <li><a href="#"><i class="fa fa-files-o" aria-hidden="true"></i> &nbsp; Uploaded Documents</a></li> -->
                <!-- <li><a data-toggle="tooltip" title="User Role : Upload User"><i class="fa fa-upload" aria-hidden="true"></i> &nbsp; Upload User</a></li> -->
                <div class="footer-place">
                  <li><a href="http://www.innovadorslab.com" target="_blank">Powered By: <b>Innovadors Lab Pvt. Ltd.</b></a></li>
                </div>
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">

                      <div class="pull-right">
                        <small><h4 class="h5">Note: after sending the document, it cannot be deleted .</h4></small>
                      </div>
                      <h3 class="h4" align='left'>Recent Uploaded Documents</h3>
                      <div class="clearfix"></div>
                      <div class="panel-group" id="accordion">
                        <% i = 1 %>
                        <% if @documents.all.count != 0  %>
                          <% @documents.each do |document| %>

                            <% if document.group.disabled == false %>
                              <div class="panel panel-default">
                                <div class="panel-heading">
                                  <h4 class="panel-title h3">
                                    <div class="row">
                                      <div class="col-sm-4">
                                        <a data-toggle="collapse" data-parent="#accordion" href="#collapse<%= i %>"><%= document.name %></a>
                                      </div>
                                      <div class="col-sm-4 text-center">
                                        <%= document.group.name if document.name %>
                                      </div>
                                      <div class="col-sm-4">
                                        <div class="pull-right h6">
                                          <% if check_status?(document) %>
                                            Sent
                                          <% else %>
                                            Not Sent
                                          <% end %>
                                        </div>
                                      </div>

                                    </div>
                                  </h4>
                                </div>
                                <div id="collapse<%= i %>" class="panel-collapse collapse">
                                  <div class="container-fluid">
                                    uploaded by : <%= document.user.username %> <br>
                                    <%= document.user.email %> <br>
                                      <div class="pull-right">
                                        <%= link_to 'Show', document, class: "btn btn-info btn-sm text-uppercase", data: {disable_with: "<i class = 'fa fa-spinner fa-spin'></i> Opening"} %> &nbsp;

                                        <% if (document.user == current_user) && (document.document_groups.empty?) %>
                                          <%= link_to 'Delete', document_path(document), method: :delete, data: { confirm: 'Are you sure?', disable_with: "<i class = 'fa fa-spinner fa-spin'></i> Deleting" }, class: "btn btn-danger btn-sm text-uppercase" %>
                                            &nbsp;
                                            <% if check_status?(document) #checkk if the document is already sent %>
                                                <%# link_to "Sent", send_doc_document_path(document), class: "btn btn-default btn-sm" %>
                                                <a href="<%= send_doc_document_path(document) %>" data-disable-with="<i class = 'fa fa-spinner fa-spin'></i> Sending" class="btn btn-default btn-sm text-uppercase">
                                                  <span class="glyphicon glyphicon-send"></span> Sent
                                                </a>

                                            <% else %>
                                                <a href="<%= send_doc_document_path(document) %>" data-disable-with="<i class = 'fa fa-spinner fa-spin'></i> Sending" class="btn btn-success btn-sm text-uppercase">
                                                  <span class="glyphicon glyphicon-send"></span> Send
                                                </a>
                                            <% end %>
                                        <% end %>
                                      </div>

                                    <br> <br>
                                  </div>
                                </div>
                              </div>
                              <% i+= 1 %>
                            <% end %>
                          <% end %>
                        <% else %>
                          <div class="jumbotron">
                            <h3 align="center text-uppercase"><b>No Documents</b></h3>
                          </div>
                        <% end %>

                      </div>

                    </div>
                </div>
            </div>
        </div>
        <!-- /#page-content-wrapper -->

    </div>
    <!-- /#wrapper -->


</div>
