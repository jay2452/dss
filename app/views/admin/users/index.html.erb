<% provide :title, "Users List" %>
<h3>List of all users</h3>

<!-- Trigger the modal with a button -->
<button type="button" class="btn btn-info btn-sm" data-toggle="modal" data-target="#myModal">New</button>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Id</th>
      <th>Email</th>
      <th colspan="3">Roles</th>
    </tr>
  </thead>

  <tbody>
    <% @users.each do |user| %>

    <tr>
      <td><%= user.id %></td>
      <td><%= link_to user.email, admin_user_path(user) %></td>

      <% fetch_roles(user.id).each do |role| %> <%# to fetch the roles of each user and it is defined in the usershelper.rb %>
        <td><%= role %></td>
      <% end %>

      <!-- <td><%= link_to "Add role", '#', class: "btn btn-primary btn-sm", :"data-toggle" => "modal", :"data-target" => "#role_modal" %></td> -->
      <td><%= link_to "Add role", new_admin_users_role_path(user_id: user.id), class: "btn btn-primary btn-sm" %></td>
      <td><%= link_to "Delete", admin_user_path(user), method: :delete, class: "btn btn-danger btn-sm" %></td>
    </tr>

    <% end %>
  </tbody>
</table>





<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">New User</h4>
      </div>
      <div class="modal-body">
        <%= form_for([:admin, @user], html: { class: "form" }) do |f| %>
          Email: <%= f.text_field :email %>
          Password : <%= f.password_field :password %>
          <%= f.submit "create" %>
        <% end %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>

<!-- <div id="role_modal" class="modal fade" role="dialog">
  <div class="modal-dialog"> -->

    <!-- Modal content-->
    <!-- <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Add role</h4>
      </div>
      <div class="modal-body">
        <%= form_for([:admin, @users_role], html: { class: "form" }) do |f| %>

          <%= f.select :role_id, Role.all.collect { |p| [ p.name, p.id ] }, include_blank: true %>
          <%= f.submit "create" %>
        <% end %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div> -->
