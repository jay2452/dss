<% if can? :create, UserGroup %>
  <!-- Modal -->
  <div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Add User</h4>
        </div>
        <div class="modal-body">
          <div class="panel panel-default">
            <div class="panel-body">
              <div id="add_user_group">
                <%= form_tag groups_add_user_to_group_path, id: "group-user-form" do %>
                  <div class="form-group">
                    Project : <%= text_field_tag "group", @group.name, readonly: true, class: "form-control" %>
                  </div>
                  <div class="form-group">
                      <!-- User : <%# select_tag "user", options_from_collection_for_select(@users, "id", "email"), {id: "custom-select", multiple: true, class: "chosen-select"} %> -->

                      <!-- User : <%# select_tag "user", options_for_select(@users.map{ |user| [user.email, user.id] }), {id: 'custom-select', multiple: true} %> -->

                      <div class="btn-group ">
                        <button data-toggle="dropdown" class="btn btn-default dropdown-toggle">Select Users <span class="caret"></span></button>
                          <ul class="dropdown-menu">
                            <% @users.each do |user| %>
                              <li style="padding: 1%; width: 400px;">
                                <input type="radio" id="ID<%= user.id %>" name="user" value="<%= user.id %>">
                                <div class="row">
                                  <div class="col-sm-6">
                                    <label for="ID<%= user.id %>"><%= user.email %></label>
                                  </div>
                                  <div class="col-sm-6">
                                    <span class="pull-right"><%= user.roles.last.name %></span>
                                  </div>
                                </div>

                              </li>
                            <% end %>
                          </ul>
                      </div>
                  </div>
                  <div class="form-group" align="center">
                    <%= submit_tag "Add user", class: "btn btn-success btn-sm text-uppercase" %>
                    <button type="button" class="btn btn-default btn-sm text-uppercase" data-dismiss="modal">Close</button>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
<% end %>


<script type="text/javascript">
  // $('#custom-select').selectpicker();
  var role = null;



  //
  //
  //
  // $('#custom-select').selectize({
  //   persist: false,
  //   valueField: 'id',
  //   labelField: 'email',
  //   searchField: 'email',
  //   create: false,
  //   options: [],
  //   render: {
  //     option: function (item, escape) {
  //
  //       function getRoleName(email) {
  //
  //         $.ajax({
  //           type: "POST",
  //             cache: false,
  //             url: "/welcome/show_role",
  //             data: {
  //               user_id: email
  //             },    // multiple data sent using ajax
  //             success: function (html) {
  //                 console.log(html);
  //                 role = html.name;
  //                 console.log(role);
  //                 return role;
  //             }
  //         });
  //       }
  //
  //       var user_role = getRoleName(item.email);
  //
  //       console.log(user_role);
  //
  //       return '<div>' +
  //                 '<span class="title">' +
  //                   '<span class="email">' + item.email + '</span>' +
  //                   '<br/><span class="role">' + escape(item.user_role) + '</span>' +
  //                 '</span>' +
  //               '</div>'
  //     }
  //   }
  // });
  //

  //
  // var abc = getRoleName("jay2452@live.com");
  // console.log(abc);

</script>
